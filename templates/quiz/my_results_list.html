{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <h1 class="mb-4">{{ quiz.title }} 결과 목록</h1>

    {% if page_obj %}
        <div class="list-group mb-4">
            {% for result in page_obj %}
                <div class="list-group-item d-flex justify-content-between align-items-center">
                    
                    <div>
                        {% if user.is_staff %}
                            <a href="{% url 'quiz:result_detail' result.id %}" class="text-primary fw-bold text-decoration-none">
                                <i class="bi bi-search"></i> [관리자용 상세] 
                                {{ result.attempt_number }}차 응시 - {{ result.completed_at|date:"Y-m-d H:i" }} / {{ result.score }}점
                            </a>
                        {% else %}
                            <span class="text-dark">
                                {{ result.attempt_number }}차 응시 - {{ result.completed_at|date:"Y-m-d H:i" }} / <strong>{{ result.score }}점</strong>
                            </span>
                        {% endif %}
                    </div>

                    <div>
                        {% if result.is_pass %}
                            <span class="badge bg-success rounded-pill">합격</span>
                        {% else %}
                            <span class="badge bg-danger rounded-pill">불합격</span>
                        {% endif %}
                    </div>
                    
                </div>
            {% endfor %}
        </div>

        {# --- 페이지네이션 (그대로 유지) --- #}
        <nav>
            <ul class="pagination justify-content-center">
                {% if page_obj.has_previous %}
                    <li class="page-item"><a class="page-link" href="?page=1">&laquo; 처음</a></li>
                    <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">이전</a></li>
                {% endif %}

                <li class="page-item active" aria-current="page">
                    <span class="page-link">{{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span>
                </li>

                {% if page_obj.has_next %}
                    <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">다음</a></li>
                    <li class="page-item"><a class="page-link" href="?page={{ page_obj.paginator.num_pages }}">마지막 &raquo;</a></li>
                {% endif %}
            </ul>
        </nav>
        
    {% else %}
        <div class="alert alert-warning mt-3">
            <strong>현재 로그인한 사용자({{ user.username }})</strong>의 시험 결과가 없습니다.
        </div>
    {% endif %}
</div>
{% endblock %}